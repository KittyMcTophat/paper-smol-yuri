[gd_scene load_steps=17 format=2]

[ext_resource path="res://Scenes/Levels/BaseLevel.tscn" type="PackedScene" id=1]
[ext_resource path="res://Sprites/Backgrounds/Sky with Moon.png" type="Texture" id=2]
[ext_resource path="res://Scenes/Actors/Overworld/Players/Players (With Party)/SmolYuri_Alone.tscn" type="PackedScene" id=3]
[ext_resource path="res://Sprites/Actors/SmolMonika/SmolMonikaStill.png" type="Texture" id=4]
[ext_resource path="res://Sprites/Actors/SmolSayori/SmolSayoriStill.png" type="Texture" id=5]
[ext_resource path="res://Scenes/Actors/Overworld/BaseActors/InteractableActor.tscn" type="PackedScene" id=6]
[ext_resource path="res://Sprites/Actors/SmolNatsuki/SmolNatsuki.png" type="Texture" id=7]
[ext_resource path="res://Scenes/Actors/Overworld/BaseActors/OverworldEnemy.tscn" type="PackedScene" id=8]
[ext_resource path="res://Scenes/Actors/Battle/Enemies/SmolNatsuki/SmolNatsuki.tscn" type="PackedScene" id=9]
[ext_resource path="res://Scenes/GUI/Credits.tscn" type="PackedScene" id=10]
[ext_resource path="res://Scenes/Objects/SmolCookie.tscn" type="PackedScene" id=11]
[ext_resource path="res://Music/Victory Over Bowser.WAV" type="AudioStream" id=12]

[sub_resource type="CapsuleShape" id=1]
resource_local_to_scene = true
margin = 0.001
radius = 0.32
height = 0.01

[sub_resource type="SphereShape" id=2]
resource_local_to_scene = true

[sub_resource type="GDScript" id=4]
script/source = "extends Node

signal music_over;

export var win_music : AudioStream = null;

func _on_OverworldEnemy_battle_end():
	MusicManager.change_music(win_music);
	
	yield(MusicManager.current_music_player, \"finished\");
	
	emit_signal(\"music_over\");
"

[sub_resource type="CapsuleShape" id=3]
resource_local_to_scene = true
margin = 0.001
radius = 0.32
height = 0.01

[node name="LevelController" instance=ExtResource( 1 )]
background_texture = ExtResource( 2 )

[node name="InteractableActor" parent="Overworld" index="0" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, -2, 0, -0.25 )
use_export_dialogue_instead = true
exported_dialogue = "[
	{\"speaker\":\"Smol Monika\", \"text\":\"Did you notice that there's no smol furniture in here?\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolMonika/Happy.png\"},
	{\"text\":\"I asked Smol Natsuki about it, but all she said was \\\"You think I can afford smol furniture? In this economy?!\\\"\", \"portrait\":\"\"},
	{\"text\":\"I'm still not sure if she was joking or not...\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolMonika/Sad.png\"},
]"

[node name="CollisionShape" parent="Overworld/InteractableActor" index="0"]
shape = SubResource( 1 )

[node name="Sprite3D" parent="Overworld/InteractableActor" index="1"]
offset = Vector2( 0, 44 )
texture = ExtResource( 4 )

[node name="CollisionShape" parent="Overworld/InteractableActor/InteractableArea" index="0"]
shape = SubResource( 2 )

[node name="InteractableActor2" parent="Overworld" index="1" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 2, 0, -0.25 )
use_export_dialogue_instead = true
exported_dialogue = "[
    {\"speaker\":\"Smol Sayori\", \"text\":\"Smol Natsuki told me about her attacks earlier.\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolSayori/Happy.png\"},
	{\"text\":\"Apparently she throws smol flaming cupcakes.\", \"portrait\":\"\"},
	{\"text\":\"But I bet she won't always remember to set them on fire.\", \"portrait\":\"\"},
	{\"text\":\"And her smol cupcakes are pretty tasty when they're not on fire!\", \"portrait\":\"\"},
	{\"text\":\"If you see a smol cupcake that isn't on fire, try eating it.\", \"portrait\":\"\"},

    {\"speaker\":\"Smol Yuri\", \"text\":\"Thanks for the information!\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolYuri/Happy.png\"},
	{\"text\":\"I'll keep it in mind during the fight.\", \"portrait\":\"\"},
]"

[node name="CollisionShape" parent="Overworld/InteractableActor2" index="0"]
shape = SubResource( 1 )

[node name="Sprite3D" parent="Overworld/InteractableActor2" index="1"]
offset = Vector2( 0, 38.5 )
texture = ExtResource( 5 )

[node name="CollisionShape" parent="Overworld/InteractableActor2/InteractableArea" index="0"]
shape = SubResource( 2 )

[node name="InteractableActor3" parent="Overworld" index="2" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1000, 0 )
use_export_dialogue_instead = true
exported_dialogue = "[
    {\"speaker\":\"Smol Natsuki\", \"text\":\"Dang it, I lost...\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolNatsuki/Sad.png\"},
    
    {\"speaker\":\"Smol Monika\", \"text\":\"That's okay, you've shown us that you're really strong!\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolMonika/Happy.png\"},
	{\"text\":\"If we go on another adventure, we'll be sure to invite you!\", \"portrait\":\"\"},

    {\"speaker\":\"Smol Natsuki\", \"text\":\"Alright, I suppose I can forgive you guys for now.\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolNatsuki/Happy.png\"},

    {\"speaker\":\"\", \"text\":\"- You Win! -\\n(For Real This Time)\\nFinal Score: [finalscore]\", \"valign\":\"center\", \"halign\":\"center\"},
    {\"text\":\"\", \"valign\":\"top\", \"halign\":\"left\"}
]"

[node name="InteractableActor4" parent="Overworld" index="3" instance=ExtResource( 6 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1000, 0 )
interact_on_ready = true
only_on_first_load = true
use_export_dialogue_instead = true
exported_dialogue = "[
    {\"speaker\":\"Smol Monika\", \"text\":\"Alright, Smol Natsuki's waiting in the corner over there.\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolMonika/Happy.png\"},
	{\"text\":\"When you're ready, go initiate a battle with her.\", \"portrait\":\"\"},
	
	{\"speaker\":\"Smol Yuri\", \"text\":\"Do you have any advice that might help me?\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolYuri/Happy.png\"},
	
	{\"speaker\":\"Smol Monika\", \"text\":\"I don't, but Smol Sayori might know something.\", \"portrait\":\"res://Sprites/DialoguePortraits/SmolMonika/Happy.png\"},
]"

[node name="Credits" parent="Overworld" index="4" instance=ExtResource( 10 )]

[node name="SetMusic" type="Node" parent="Overworld" index="5"]
script = SubResource( 4 )
win_music = ExtResource( 12 )

[node name="SmolCookie" parent="Overworld" index="6" instance=ExtResource( 11 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1000, 0 )
next_scene = "res://Scenes/TitleScreen.tscn"

[node name="OverworldEnemy" parent="Overworld" index="7" instance=ExtResource( 8 )]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, 0 )
move_speed = 0.0
jump_strength = 0.0
move_lerp = 0.0
enemies = [ ExtResource( 9 ) ]
reward_money = 125

[node name="CollisionShape" parent="Overworld/OverworldEnemy" index="0"]
shape = SubResource( 3 )

[node name="Sprite3D" parent="Overworld/OverworldEnemy" index="1"]
offset = Vector2( 0, 40 )
flip_h = true
texture = ExtResource( 7 )

[node name="Sprite3D" type="Sprite3D" parent="Overworld" index="8"]
transform = Transform( 1, 0, 0, 0, 1, 0, 0, 0, 1, 4, 0, 0 )
offset = Vector2( 0, 40 )
flip_h = true
alpha_cut = 1
texture = ExtResource( 7 )

[node name="SmolYuri_Alone" parent="Overworld" index="9" instance=ExtResource( 3 )]

[node name="GridMap Ground" parent="Overworld" index="10"]
data = {
"cells": PoolIntArray( 9, 0, 2, 65530, 0, 2, 262153, 0, 2, 327674, 0, 2, 327680, 0, 5, 327681, 0, 5, 327682, 0, 5, 327683, 0, 5, 327684, 0, 5, 327685, 0, 5, 327686, 0, 5, 327687, 0, 5, 327688, 0, 5, 327689, 0, 5, 393210, 0, 5, 393211, 0, 5, 393212, 0, 5, 393213, 0, 5, 393214, 0, 5, 393215, 0, 5, -65536, 0, 4, -65535, 0, 4, -65534, 0, 4, -65533, 0, 4, -65532, 0, 4, -65531, 0, 4, -65530, 0, 4, -65529, 0, 4, -65528, 0, 4, -65527, 0, 2, -6, 0, 2, -5, 0, 4, -4, 0, 4, -3, 0, 4, -2, 0, 4, -1, 0, 4, 9, 1, 2, 65530, 1, 2, 262153, 1, 2, 327674, 1, 2, 327680, 1, 5, 327681, 1, 5, 327682, 1, 5, 327683, 1, 5, 327684, 1, 5, 327685, 1, 5, 327686, 1, 5, 327687, 1, 5, 327688, 1, 5, 327689, 1, 5, 393210, 1, 5, 393211, 1, 5, 393212, 1, 5, 393213, 1, 5, 393214, 1, 5, 393215, 1, 5, -65536, 1, 4, -65535, 1, 4, -65534, 1, 4, -65533, 1, 4, -65532, 1, 4, -65531, 1, 4, -65530, 1, 4, -65529, 1, 4, -65528, 1, 4, -65527, 1, 2, -6, 1, 2, -5, 1, 4, -4, 1, 4, -3, 1, 4, -2, 1, 4, -1, 1, 4, 9, 2, 2, 65530, 2, 2, 262153, 2, 2, 327674, 2, 2, 327680, 2, 5, 327681, 2, 5, 327682, 2, 5, 327683, 2, 5, 327684, 2, 5, 327685, 2, 5, 327686, 2, 5, 327687, 2, 5, 327688, 2, 5, 327689, 2, 5, 393210, 2, 5, 393211, 2, 5, 393212, 2, 5, 393213, 2, 5, 393214, 2, 5, 393215, 2, 5, -65536, 2, 4, -65535, 2, 4, -65534, 2, 4, -65533, 2, 4, -65532, 2, 4, -65531, 2, 4, -65530, 2, 4, -65529, 2, 4, -65528, 2, 4, -65527, 2, 2, -6, 2, 2, -5, 2, 4, -4, 2, 4, -3, 2, 4, -2, 2, 4, -1, 2, 4, 9, 3, 2, 65530, 3, 2, 262153, 3, 2, 327674, 3, 2, 327680, 3, 5, 327681, 3, 5, 327682, 3, 5, 327683, 3, 5, 327684, 3, 5, 327685, 3, 5, 327686, 3, 5, 327687, 3, 5, 327688, 3, 5, 327689, 3, 5, 393210, 3, 5, 393211, 3, 5, 393212, 3, 5, 393213, 3, 5, 393214, 3, 5, 393215, 3, 5, -65536, 3, 4, -65535, 3, 4, -65534, 3, 4, -65533, 3, 4, -65532, 3, 4, -65531, 3, 4, -65530, 3, 4, -65529, 3, 4, -65528, 3, 4, -65527, 3, 2, -6, 3, 2, -5, 3, 4, -4, 3, 4, -3, 3, 4, -2, 3, 4, -1, 3, 4, 9, 4, 2, 65530, 4, 2, 65545, 4, 2, 131066, 4, 2, 131081, 4, 2, 196602, 4, 2, 196617, 4, 2, 262138, 4, 2, 262153, 4, 2, 327674, 4, 2, 327680, 4, 5, 327681, 4, 5, 327682, 4, 5, 327683, 4, 5, 327684, 4, 5, 327685, 4, 5, 327686, 4, 5, 327687, 4, 5, 327688, 4, 5, 327689, 4, 5, 393210, 4, 5, 393211, 4, 5, 393212, 4, 5, 393213, 4, 5, 393214, 4, 5, 393215, 4, 5, -65536, 4, 4, -65535, 4, 4, -65534, 4, 4, -65533, 4, 4, -65532, 4, 4, -65531, 4, 4, -65530, 4, 4, -65529, 4, 4, -65528, 4, 4, -65527, 4, 2, -6, 4, 2, -5, 4, 4, -4, 4, 4, -3, 4, 4, -2, 4, 4, -1, 4, 4, 0, 5, 2, 1, 5, 2, 2, 5, 2, 3, 5, 2, 4, 5, 2, 5, 5, 2, 6, 5, 2, 7, 5, 2, 8, 5, 2, 9, 5, 2, 65530, 5, 2, 65531, 5, 2, 65532, 5, 2, 65533, 5, 2, 65534, 5, 2, 65535, 5, 2, 65536, 5, 2, 65537, 5, 2, 65538, 5, 2, 65539, 5, 2, 65540, 5, 2, 65541, 5, 2, 65542, 5, 2, 65543, 5, 2, 65544, 5, 2, 65545, 5, 2, 131066, 5, 2, 131067, 5, 2, 131068, 5, 2, 131069, 5, 2, 131070, 5, 2, 131071, 5, 2, 131072, 5, 2, 131073, 5, 2, 131074, 5, 2, 131075, 5, 2, 131076, 5, 2, 131077, 5, 2, 131078, 5, 2, 131079, 5, 2, 131080, 5, 2, 131081, 5, 2, 196602, 5, 2, 196603, 5, 2, 196604, 5, 2, 196605, 5, 2, 196606, 5, 2, 196607, 5, 2, 196608, 5, 2, 196609, 5, 2, 196610, 5, 2, 196611, 5, 2, 196612, 5, 2, 196613, 5, 2, 196614, 5, 2, 196615, 5, 2, 196616, 5, 2, 196617, 5, 2, 262138, 5, 2, 262139, 5, 2, 262140, 5, 2, 262141, 5, 2, 262142, 5, 2, 262143, 5, 2, 262144, 5, 2, 262145, 5, 2, 262146, 5, 2, 262147, 5, 2, 262148, 5, 2, 262149, 5, 2, 262150, 5, 2, 262151, 5, 2, 262152, 5, 2, 262153, 5, 2, 327674, 5, 2, 327675, 5, 2, 327676, 5, 2, 327677, 5, 2, 327678, 5, 2, 327679, 5, 2, 327680, 5, 5, 327681, 5, 5, 327682, 5, 5, 327683, 5, 5, 327684, 5, 5, 327685, 5, 5, 327686, 5, 5, 327687, 5, 5, 327688, 5, 5, 327689, 5, 5, 393210, 5, 5, 393211, 5, 5, 393212, 5, 5, 393213, 5, 5, 393214, 5, 5, 393215, 5, 5, -65536, 5, 2, -65535, 5, 2, -65534, 5, 2, -65533, 5, 2, -65532, 5, 2, -65531, 5, 2, -65530, 5, 2, -65529, 5, 2, -65528, 5, 2, -65527, 5, 2, -6, 5, 2, -5, 5, 2, -4, 5, 2, -3, 5, 2, -2, 5, 2, -1, 5, 2, 65468, 164, 1, 0, 65534, 2, 1, 65534, 2, 2, 65534, 2, 3, 65534, 2, 4, 65534, 2, 5, 65534, 2, 6, 65534, 2, 7, 65534, 2, 8, 65534, 2, 9, 65534, 2, 65530, 65534, 2, 65531, 65534, 2, 65532, 65534, 2, 65533, 65534, 2, 65534, 65534, 2, 65535, 65534, 2, 65544, 65534, 2, 65545, 65534, 2, 131066, 65534, 2, 131067, 65534, 2, 131080, 65534, 2, 131081, 65534, 2, 196602, 65534, 2, 196603, 65534, 2, 196616, 65534, 2, 196617, 65534, 2, 262138, 65534, 2, 262139, 65534, 2, 262144, 65534, 2, 262145, 65534, 2, 262146, 65534, 2, 262147, 65534, 2, 262148, 65534, 2, 262149, 65534, 2, 262150, 65534, 2, 262151, 65534, 2, 262152, 65534, 2, 262153, 65534, 2, 327674, 65534, 2, 327675, 65534, 2, 327676, 65534, 2, 327677, 65534, 2, 327678, 65534, 2, 327679, 65534, 2, 327680, 65534, 5, 327681, 65534, 5, 327682, 65534, 5, 327683, 65534, 5, 327684, 65534, 5, 327685, 65534, 5, 327686, 65534, 5, 327687, 65534, 5, 327688, 65534, 5, 327689, 65534, 5, 393210, 65534, 5, 393211, 65534, 5, 393212, 65534, 5, 393213, 65534, 5, 393214, 65534, 5, 393215, 65534, 5, -65536, 65534, 2, -65535, 65534, 2, -65534, 65534, 2, -65533, 65534, 2, -65532, 65534, 2, -65531, 65534, 2, -65530, 65534, 2, -65529, 65534, 2, -65528, 65534, 2, -65527, 65534, 2, -6, 65534, 2, -5, 65534, 2, -4, 65534, 2, -3, 65534, 2, -2, 65534, 2, -1, 65534, 2, 9, 65535, 2, 65530, 65535, 2, 65545, 65535, 2, 131066, 65535, 2, 131081, 65535, 2, 196602, 65535, 2, 196617, 65535, 2, 262138, 65535, 2, 262153, 65535, 2, 327674, 65535, 2, 327680, 65535, 5, 327681, 65535, 5, 327682, 65535, 5, 327683, 65535, 5, 327684, 65535, 5, 327685, 65535, 5, 327686, 65535, 5, 327687, 65535, 5, 327688, 65535, 5, 327689, 65535, 5, 393210, 65535, 5, 393211, 65535, 5, 393212, 65535, 5, 393213, 65535, 5, 393214, 65535, 5, 393215, 65535, 5, -65536, 65535, 4, -65535, 65535, 4, -65534, 65535, 4, -65533, 65535, 4, -65532, 65535, 4, -65531, 65535, 4, -65530, 65535, 4, -65529, 65535, 4, -65528, 65535, 4, -65527, 65535, 2, -6, 65535, 2, -5, 65535, 4, -4, 65535, 4, -3, 65535, 4, -2, 65535, 4, -1, 65535, 4 )
}

[node name="GridMap Spikes" parent="Overworld" index="11"]
data = {
"cells": PoolIntArray(  )
}

[node name="Battle" parent="." index="1"]
visible = false

[node name="GridMap" parent="Battle" index="3"]
data = {
"cells": PoolIntArray( -196608, 0, 1, -196607, 0, 1, -196606, 0, 1, -196605, 0, 1, -196604, 0, 1, -196603, 0, 1, -196602, 0, 1, -196601, 0, 1, -196600, 0, 1, -196599, 0, 1, -131082, 0, 1, -131081, 0, 1, -131080, 0, 1, -131079, 0, 1, -131078, 0, 1, -131077, 0, 1, -131076, 0, 1, -131075, 0, 1, -131074, 0, 1, -131073, 0, 1, -131072, 0, 1, -131071, 0, 1, -131070, 0, 1, -131069, 0, 1, -131068, 0, 1, -131067, 0, 1, -131066, 0, 1, -131065, 0, 1, -131064, 0, 1, -131063, 0, 1, -65546, 0, 1, -65545, 0, 1, -65544, 0, 1, -65543, 0, 1, -65542, 0, 1, -65541, 0, 1, -65540, 0, 1, -65539, 0, 1, -65538, 0, 1, -65537, 0, 1, -65536, 0, 0, -65535, 0, 0, -65534, 0, 0, -65533, 0, 0, -65532, 0, 0, -65531, 0, 0, -65530, 0, 0, -65529, 0, 0, -65528, 0, 0, -65527, 0, 0, -10, 0, 0, -9, 0, 0, -8, 0, 0, -7, 0, 0, -6, 0, 0, -5, 0, 0, -4, 0, 0, -3, 0, 0, -2, 0, 0, -1, 0, 0, -196608, 65535, 1, -196607, 65535, 1, -196606, 65535, 1, -196605, 65535, 1, -196604, 65535, 1, -196603, 65535, 1, -196602, 65535, 1, -196601, 65535, 1, -196600, 65535, 1, -196599, 65535, 1, -131082, 65535, 1, -131081, 65535, 1, -131080, 65535, 1, -131079, 65535, 1, -131078, 65535, 1, -131077, 65535, 1, -131076, 65535, 1, -131075, 65535, 1, -131074, 65535, 1, -131073, 65535, 1, -131072, 65535, 1, -131071, 65535, 1, -131070, 65535, 1, -131069, 65535, 1, -131068, 65535, 1, -131067, 65535, 1, -131066, 65535, 1, -131065, 65535, 1, -131064, 65535, 1, -131063, 65535, 1, -65546, 65535, 1, -65545, 65535, 1, -65544, 65535, 1, -65543, 65535, 1, -65542, 65535, 1, -65541, 65535, 1, -65540, 65535, 1, -65539, 65535, 1, -65538, 65535, 1, -65537, 65535, 1, -65536, 65535, 0, -65535, 65535, 0, -65534, 65535, 0, -65533, 65535, 0, -65532, 65535, 0, -65531, 65535, 0, -65530, 65535, 0, -65529, 65535, 0, -65528, 65535, 0, -65527, 65535, 0, -10, 65535, 0, -9, 65535, 0, -8, 65535, 0, -7, 65535, 0, -6, 65535, 0, -5, 65535, 0, -4, 65535, 0, -3, 65535, 0, -2, 65535, 0, -1, 65535, 0 )
}

[connection signal="dialogue_ended" from="Overworld/InteractableActor3" to="Overworld/Credits" method="_roll_credits"]
[connection signal="credits_over" from="Overworld/Credits" to="Overworld/SmolCookie" method="collect"]
[connection signal="battle_end" from="Overworld/OverworldEnemy" to="Overworld/InteractableActor3" method="_interact"]
[connection signal="battle_end" from="Overworld/OverworldEnemy" to="Overworld/SetMusic" method="_on_OverworldEnemy_battle_end"]

[editable path="Overworld/InteractableActor"]
[editable path="Overworld/InteractableActor2"]
[editable path="Overworld/OverworldEnemy"]
